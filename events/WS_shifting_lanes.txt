namespace = ws_shifting_lanes





event = {
	id = ws_shifting_lanes.01

	is_triggered_only = yes
	hide_window = yes

	trigger = {
		always = yes
		has_global_flag = shifting_lanes_dynamic
	}

	immediate = {
		every_system = {
			limit = {
				is_star_class = sc_dn
			}
			random_neighbor_system = {
				limit = {
					has_hyperlane_to = PREV
				}
				remove_hyperlane = {
					from = PREV
					to = THIS
				}
			}
			random_neighbor_system_euclidean = {
				limit = {
					NOT = {
						has_hyperlane_to = PREV				
					}
					NOR = {
						# Start System Flags
						has_star_flag = empire_home_system
						has_star_flag = neighbor_t1
						has_star_flag = neighbor_t1_first_colony
						has_star_flag = neighbor_t2
						has_star_flag = neighbor_t2_second_colony
						has_star_flag = empire_cluster
						# Enclaves
						has_star_flag = enclave
						has_star_flag = caravaneer_home
						# L-Gate
						has_star_flag = lgate
						has_star_flag = lcluster1
						has_star_flag = lcluster2
						has_star_flag = lcluster3
						has_star_flag = lcluster4
						has_star_flag = lcluster5
						has_star_flag = lcluster_lgate
						has_star_flag = lgateguaranteed
						has_star_flag = crystal_system
						has_star_flag = crystal_splitter_starting_system
						has_star_flag = crystal_splitter_destination_system
						# Hostile Systems
						has_star_flag = marauder_system
						has_star_flag = hostile_system
						has_star_flag = guardian
						has_star_flag = sealed_system
						# Others
						has_star_flag = mechanocalibrator_system
						has_star_flag = rubricator_system
						has_star_flag = last_baol_system
						has_star_flag = Zrocursor
						has_star_flag = overlord_empire_flag
					}
				}
				add_hyperlane = {
					from = THIS
					to = PREV
				}
			}
		}
	}
}
